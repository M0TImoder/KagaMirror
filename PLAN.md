# PLAN.md

超高画質・高フレームレート・低遅延のリモートデスクトップソフト

## 目的

クソ高性能なOSS作って既得権益潰すおww

## 使用言語

- C++
- Rust

## 各言語の役割

- C++
  - GPUキャプチャ
  - エンコード/デコード
  - フレーム最適化
  - 描画
- Rust
  - 通信(WebRTC)
  - 暗号
  - 認証
  - セッション制御
  - NAT処理

## 自作するもの

以下のものは既存のライブラリを用いず自作する

1. フレームパイプライン設計
	GPUテクスチャ→NVENC→GPU上のビットストリーム→最小コピーでUDP送信  
	- GPU→CPUコピーを排除
	- フレームバッファをリング化
	- ロックフリーキュー化

2. Dirty Regionアルゴリズム
	汎用実装からの脱却  

3. レイテンシ特化エンコード制御
  NVENCを使うが一部は自作する  
	- GOP動的制御
	- Iフレーム挿入タイミング
	- VBVバッファ制御
	- 短期ビットレート上げ

4. ネットワーク層の軽量化
	WebRTCは便利だが重い
	- 独自UDPプロトコル
	- 独自再送戦略
	- FEC最適化
	- 帯域推定をシンプル化
  セキュリティとNAT処理は自作しない

5. スレッドスケジューリング
  - キャプチャスレッドをリアルタイム優先度付け
  - エンコード専用コア固定
  - NUMA最適化
  - スピンロック削減
